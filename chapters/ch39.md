> # 39. Weighting data

# 39. ƒê√°nh tr·ªçng s·ªë d·ªØ li·ªáu

> Suppose you have 200,000 images from the internet and 5,000 images from your mobile app users. There is a 40:1 ratio between the size of these datasets. In theory, so long as you build a huge neural network and train it long enough on all 205,000 images, there is no harm in trying to make the algorithm do well on both internet images and mobile images.

Gi·∫£ s·ª≠ b·∫°n c√≥ 200,000 h√¨nh ·∫£nh t·ª´ internet v√† 5,000 h√¨nh ·∫£nh t·ª´ ng∆∞·ªùi d√πng ·ª©ng d·ª•ng di ƒë·ªông c·ªßa b·∫°n. T·ª∑ l·ªá k√≠ch th∆∞·ªõc gi·ªØa c√°c b·ªô d·ªØ li·ªáu n√†y l√† 40: 1. V·ªÅ l√Ω thuy·∫øt, mi·ªÖn l√† b·∫°n x√¢y d·ª±ng m·ªôt m·∫°ng neural kh·ªïng l·ªì v√† hu·∫•n luy·ªán n√≥ ƒë·ªß l√¢u tr√™n t·∫•t c·∫£ 205,000 h√¨nh ·∫£nh th√¨ s·∫Ω kh√¥ng c√≥ v·∫•n ƒë·ªÅ g√¨ khi c·ªë g·∫Øng l√†m cho thu·∫≠t to√°n ho·∫°t ƒë·ªông t·ªët tr√™n c·∫£ h√¨nh ·∫£nh t·ª´ internet v√† h√¨nh ·∫£nh t·ª´ di ƒë·ªông.

> But in practice, having 40x as many internet images as mobile app images might mean you need to spend 40x (or more) as much computational resources to model both, compared to if you trained on only the 5,000 images.

Nh∆∞ng tr√™n th·ª±c t·∫ø, vi·ªác c√≥ h√¨nh ·∫£nh t·ª´ internet g·∫•p 40 l·∫ßn so v·ªõi h√¨nh ·∫£nh t·ª´ ·ª©ng d·ª•ng di ƒë·ªông c√≥ th·ªÉ nghƒ©a l√† b·∫°n c·∫ßn ph·∫£i s·ª≠ d·ª•ng 40 l·∫ßn (ho·∫∑c nhi·ªÅu h∆°n) t√†i nguy√™n t√≠nh to√°n ƒë·ªÉ m√¥ h√¨nh h√≥a c·∫£ hai, so v·ªõi n·∫øu b·∫°n ch·ªâ ƒë√†o t·∫°o tr√™n 5,000 h√¨nh ·∫£nh.

> If you don‚Äôt have huge computational resources, you could give the internet images a much lower weight as a compromise.

N·∫øu b·∫°n kh√¥ng c√≥ t√†i nguy√™n t√≠nh to√°n kh·ªïng l·ªì, b·∫°n c√≥ th·ªÉ g√°n tr·ªçng s·ªë th·∫•p h∆°n nhi·ªÅu cho c√°c h√¨nh ·∫£nh t·ª´ internet nh∆∞ m·ªôt c√°ch th·ªèa hi·ªáp.

> For example, suppose your optimization objective is squared error (This is not a good choice for a classification task, but it will simplify our explanation.) Thus, our learning algorithm tries to optimize:

V√≠ d·ª•, gi·∫£ s·ª≠ m·ª•c ti√™u t·ªëi ∆∞u c·ªßa b·∫°n l√† sai s·ªë to√†n ph∆∞∆°ng (ƒê√¢y kh√¥ng ph·∫£i l√† m·ªôt l·ª±a ch·ªçn t·ªët cho m·ªôt t√°c v·ª• ph√¢n lo·∫°i, nh∆∞ng n√≥ s·∫Ω ƒë∆°n gi·∫£n h√≥a l·ªùi gi·∫£i th√≠ch c·ªßa ch√∫ng ta.) V√¨ v·∫≠y, thu·∫≠t to√°n h·ªçc t·∫≠p c·ªßa ch√∫ng ta c·ªë g·∫Øng t·ªëi ∆∞u h√≥a:

![img](../imgs/C39_01.png)

> The first sum above is over the 5,000 mobile images, and the second sum is over the 200,000 internet images. You can instead optimize with an additional parameter ‚ÄãùõΩ‚Äã:

T·ªïng ƒë·∫ßu ti√™n ph√≠a tr√™n l√† h∆°n 5,000 h√¨nh ·∫£nh t·ª´ di ƒë·ªông v√† t·ªïng th·ª© hai l√† h∆°n 200,000 h√¨nh ·∫£nh t·ª´ internet. Thay v√†o ƒë√≥, b·∫°n c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v·ªõi m·ªôt tham s·ªë b·ªï sung ‚ÄãùõΩ‚Äã:

![img](../imgs/C39_02.png)

> If you set ‚ÄãùõΩ‚Äã=1/40, the algorithm would give equal weight to the 5,000 mobile images and the 200,000 internet images. You can also set the parameter ‚ÄãùõΩ‚Äã to other values, perhaps by tuning to the dev set.
  
N·∫øu b·∫°n ƒë·∫∑t ‚ÄãùõΩ‚Äã = 1/40, thu·∫≠t to√°n s·∫Ω g√°n tr·ªçng s·ªë t∆∞∆°ng ƒë∆∞∆°ng cho 5,000 h√¨nh ·∫£nh t·ª´ di ƒë·ªông v√† 200,000 h√¨nh ·∫£nh t·ª´ internet. B·∫°n c≈©ng c√≥ th·ªÉ ƒë·∫∑t tham s·ªë ‚ÄãùõΩ‚Äã th√†nh c√°c gi√° tr·ªã kh√°c, c√≥ th·ªÉ b·∫±ng c√°ch ƒëi·ªÅu ch·ªânh theo t·∫≠p ph√°t tri·ªÉn.

> By weighting the additional Internet images less, you don‚Äôt have to build as massive a neural network to make sure the algorithm does well on both types of tasks. This type of re-weighting is needed only when you suspect the additional data (Internet Images) has a very different distribution than the dev/test set, or if the additional data is much larger than the data that came from the same distribution as the dev/test set (mobile images).

Khi gi·∫£m tr·ªçng s·ªë c√°c h√¨nh ·∫£nh b·ªï sung t·ª´ Internet, b·∫°n kh√¥ng ph·∫£i x√¢y d·ª±ng m·ªôt m·∫°ng neural kh·ªïng l·ªì ƒë·ªÉ ƒë·∫£m b·∫£o thu·∫≠t to√°n th·ª±c hi·ªán t·ªët c·∫£ hai lo·∫°i t√°c v·ª•. Vi·ªác ƒë√°nh l·∫°i tr·ªçng s·ªë n√†y ch·ªâ c·∫ßn thi·∫øt khi b·∫°n nghi ng·ªù d·ªØ li·ªáu b·ªï sung (H√¨nh ·∫£nh t·ª´ Internet) c√≥ ph√¢n ph·ªëi r·∫•t kh√°c so v·ªõi t·∫≠p ph√°t tri·ªÉn/ t·∫≠p ki·ªÉm tra, ho·∫∑c n·∫øu d·ªØ li·ªáu b·ªï sung l·ªõn h∆°n nhi·ªÅu so v·ªõi d·ªØ li·ªáu m√† c√≥ c√πng ph√¢n ph·ªëi v·ªõi t·∫≠p ph√°t tri·ªÉn/ t·∫≠p ki·ªÉm tra (h√¨nh ·∫£nh t·ª´ di ƒë·ªông).
