> # 39. Weighting data

# 39. ÄÃ¡nh trá»ng sá»‘ dá»¯ liá»‡u

> Suppose you have 200,000 images from the internet and 5,000 images from your mobile app users. There is a 40:1 ratio between the size of these datasets. In theory, so long as you build a huge neural network and train it long enough on all 205,000 images, there is no harm in trying to make the algorithm do well on both internet images and mobile images.

Giáº£ sá»­ báº¡n cÃ³ 200.000 hÃ¬nh áº£nh tá»« internet vÃ  5.000 hÃ¬nh áº£nh tá»« ngÆ°á»i dÃ¹ng á»©ng dá»¥ng di Ä‘á»™ng cá»§a báº¡n. Tá»· lá»‡ kÃ­ch thÆ°á»›c giá»¯a cÃ¡c bá»™ dá»¯ liá»‡u nÃ y lÃ  40:1. Vá» lÃ½ thuyáº¿t, miá»…n lÃ  báº¡n xÃ¢y dá»±ng má»™t máº¡ng nÆ¡-ron khá»•ng lá»“ vÃ  huáº¥n luyá»‡n nÃ³ Ä‘á»§ lÃ¢u trÃªn táº¥t cáº£ 205.000 hÃ¬nh áº£nh thÃ¬ sáº½ khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ khi cá»‘ gáº¯ng lÃ m cho thuáº­t toÃ¡n hoáº¡t Ä‘á»™ng tá»‘t trÃªn cáº£ hÃ¬nh áº£nh tá»« internet vÃ  hÃ¬nh áº£nh tá»« di Ä‘á»™ng.

> But in practice, having 40x as many internet images as mobile app images might mean you need to spend 40x (or more) as much computational resources to model both, compared to if you trained on only the 5,000 images.

NhÆ°ng trÃªn thá»±c táº¿, viá»‡c cÃ³ hÃ¬nh áº£nh tá»« internet gáº¥p 40 láº§n so vá»›i hÃ¬nh áº£nh tá»« á»©ng dá»¥ng di Ä‘á»™ng cÃ³ thá»ƒ nghÄ©a lÃ  báº¡n cáº§n pháº£i sá»­ dá»¥ng 40 láº§n (hoáº·c nhiá»u hÆ¡n) tÃ i nguyÃªn tÃ­nh toÃ¡n Ä‘á»ƒ mÃ´ hÃ¬nh hÃ³a cáº£ hai, so vá»›i náº¿u báº¡n chá»‰ Ä‘Ã o táº¡o trÃªn 5.000 hÃ¬nh áº£nh.

> If you donâ€™t have huge computational resources, you could give the internet images a much lower weight as a compromise.

Náº¿u báº¡n khÃ´ng cÃ³ tÃ i nguyÃªn tÃ­nh toÃ¡n khá»•ng lá»“, báº¡n cÃ³ thá»ƒ thoáº£ hiá»‡p báº±ng cÃ¡ch gÃ¡n trá»ng sá»‘ vá»›i giÃ¡ trá»‹ tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ cho cÃ¡c hÃ¬nh áº£nh tá»« internet.

> For example, suppose your optimization objective is squared error (This is not a good choice for a classification task, but it will simplify our explanation.) Thus, our learning algorithm tries to optimize:

VÃ­ dá»¥, giáº£ sá»­ má»¥c tiÃªu tá»‘i Æ°u cá»§a báº¡n lÃ  sai sá»‘ bÃ¬nh phÆ°Æ¡ng (ÄÃ¢y khÃ´ng pháº£i lÃ  má»™t lá»±a chá»n tá»‘t cho má»™t tÃ¡c vá»¥ phÃ¢n loáº¡i, nhÆ°ng nÃ³ sáº½ Ä‘Æ¡n giáº£n hÃ³a lá»i giáº£i thÃ­ch cá»§a chÃºng ta.) VÃ¬ váº­y, thuáº­t toÃ¡n há»c táº­p cá»§a chÃºng ta cá»‘ gáº¯ng tá»‘i Æ°u hÃ³a:

![img](../imgs/C39_01.png)

> The first sum above is over the 5,000 mobile images, and the second sum is over the 200,000 internet images. You can instead optimize with an additional parameter â€‹ğ›½â€‹:

Tá»•ng Ä‘áº§u tiÃªn phÃ­a trÃªn lÃ  trÃªn 5.000 hÃ¬nh áº£nh tá»« di Ä‘á»™ng vÃ  tá»•ng thá»© hai lÃ  trÃªn 200.000 hÃ¬nh áº£nh tá»« internet. Báº¡n cÅ©ng cÃ³ thá»ƒ tá»‘i Æ°u vá»›i má»™t tham sá»‘ bá»• sung â€‹ğ›½â€‹:

![img](../imgs/C39_02.png)

> If you set â€‹ğ›½â€‹=1/40, the algorithm would give equal weight to the 5,000 mobile images and the 200,000 internet images. You can also set the parameter â€‹ğ›½â€‹ to other values, perhaps by tuning to the dev set.
  
Náº¿u báº¡n chá»n trá»ng sá»‘ â€‹ğ›½â€‹ = 1/40, thuáº­t toÃ¡n sáº½ Ä‘á»‘i xá»­ vá»›i 5.000 hÃ¬nh áº£nh tá»« di Ä‘á»™ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i 200.000 hÃ¬nh áº£nh tá»« internet. Báº¡n cÅ©ng cÃ³ thá»ƒ chá»n cÃ¡c giÃ¡ trá»‹ khÃ¡c cho â€‹ğ›½â€‹, cháº³ng háº¡n nhÆ° tinh chá»‰nh theo táº­p phÃ¡t triá»ƒn.

> By weighting the additional Internet images less, you donâ€™t have to build as massive a neural network to make sure the algorithm does well on both types of tasks. This type of re-weighting is needed only when you suspect the additional data (Internet Images) has a very different distribution than the dev/test set, or if the additional data is much larger than the data that came from the same distribution as the dev/test set (mobile images).

Khi giáº£m trá»ng sá»‘ cÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c bá»• sung tá»« Internet, báº¡n khÃ´ng cáº§n pháº£i xÃ¢y dá»±ng má»™t máº¡ng nÆ¡-ron khá»•ng lá»“ Ä‘á»ƒ Ä‘áº£m báº£o thuáº­t toÃ¡n thá»±c hiá»‡n tá»‘t trÃªn cáº£ hai tÃ¡c vá»¥. Viá»‡c Ä‘Ã¡nh láº¡i trá»ng sá»‘ nÃ y chá»‰ cáº§n thiáº¿t khi báº¡n nghi ngá» dá»¯ liá»‡u bá»• sung (hÃ¬nh áº£nh tá»« internet) cÃ³ phÃ¢n phá»‘i ráº¥t khÃ¡c so vá»›i táº­p phÃ¡t triá»ƒn/kiá»ƒm tra, hoáº·c náº¿u dá»¯ liá»‡u bá»• sung lá»›n hÆ¡n nhiá»u so vá»›i dá»¯ liá»‡u mÃ  cÃ³ cÃ¹ng phÃ¢n phá»‘i vá»›i táº­p phÃ¡t triá»ƒn/kiá»ƒm tra (hÃ¬nh áº£nh tá»« di Ä‘á»™ng).
